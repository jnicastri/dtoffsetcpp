// ConsoleApplication3.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include <iostream>
#include <ctime>
#include <string>
#include <regex>

using namespace std;

int main()
{
	std::string startTime = "2016/05/18 13:10:00";

	time_t tStart;
	int yy, month, dd, hh, mm, ss;
	struct tm whenStart;
	const char *zStart = startTime.c_str();

	// Match 
	// 2099-12-30 15:25:19
	// ^(19|20)\d\d-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 2099/12/30 15:25:19
	// ^(19|20)\d\d\/(0[1-9]|1[012])\/(0[1-9]|[12][0-9]|3[01]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 2099.12.30 15:25:19
	// ^(19|20)\d\d\.(0[1-9]|1[012])\.(0[1-9]|[12][0-9]|3[01]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 2099-30-12 15:25:19
	// ^(19|20)\d\d-(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[012]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 2099/30/12 15:25:19
	// ^(19|20)\d\d\/(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[012]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 2099.30.12 15:25:19
	// ^(19|20)\d\d\.(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 30-12-2099 15:25:19
	// ^(0[1-9]|[12][0-9]|3[01])-(0[1-9]|1[012])-(19|20)\d\d ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 30/12/2099 15:25:19
	// ^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[012])\/(19|20)\d\d ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 30.12.2099 15:25:19
	// ^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 12-30-2099 15:25:19
	// ^(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])-(19|20)\d\d ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 12/30/2099 15:25:19
	// ^(0[1-9]|1[012])\/(0[1-9]|[12][0-9]|3[01])\/(19|20)\d\d ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//
	// 12.30.2099 15:25:19
	// ^(0[1-9]|1[012])\.(0[1-9]|[12][0-9]|3[01])\.(19|20)\d\d ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]
	//



	int i = sscanf_s(zStart, "%d/%d/%d %d:%d:%d", &yy, &month, &dd, &hh, &mm, &ss);
	whenStart.tm_year = yy - 1900;
	whenStart.tm_mon = month - 1;
	whenStart.tm_mday = dd;
	whenStart.tm_hour = hh;
	whenStart.tm_min = mm;
	whenStart.tm_sec = ss;
	whenStart.tm_isdst = -1;

	tStart = mktime(&whenStart);

	std::cout << tStart << std::endl;

	string dateString("2099/12/30 15:25:19");

	regex pattern("^(19|20)\d\d/(0[1-9]|1[012])/(0[1-9]|[12][0-9]|3[01]) ([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]", std::regex::extended);

	smatch res;

	if (regex_search(dateString, res, pattern)) {
		cout << res[0];
	}
}

